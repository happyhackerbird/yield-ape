// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "lib/forge-std/src/Test.sol";
import {Yield} from "src/Yield.sol";
import {Ape} from "src/Ape.sol";
import {AxelarGas} from "src/AxelarGas.sol";
import "src/interfaces/IERC20.sol";

contract YieldTest is Test {
    Yield yield;
    Ape ape;
    AxelarGas gas;
    address axelarBaseGateway = 0xe432150cce91c13a887f7D836923d5597adD8E31;
    address constant axlUSDC = 0xEB466342C4d449BC9f53A865D5Cb90586f405215;

    function setUp() public {
        yield = new Yield(axelarBaseGateway);
        ape = new Ape(axelarBaseGateway);
        gas = new AxelarGas();
    }

    // function test_executeWithToken() public {
    //     yield.executeWithToken(
    //         bytes32(0),
    //         "mantle",
    //         "0xe432150cce91c13a887f7D836923d5597adD8E31",
    //         "payload",
    //         "weth-wei",
    //         100
    //     );
    // }

    function test_gas() public {
        deal(address(gas), 100e18);
        gas.payGas{value: 5e18}(address(0));
    }

    function test_ape() public {
        test_gas(); // wont work with this - wrong address in sender
        deal(axlUSDC, address(ape), 1e18);
        assertEq(IERC20(axlUSDC).balanceOf(address(ape)), 1e18);
        ape.ape(
            "0x12aa3caf00000000000000000000000026271dfddbd250014f87f0f302c099d5a798bab1000000000000000000000000eb466342c4d449bc9f53a865d5cb90586f405215000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000026271dfddbd250014f87f0f302c099d5a798bab1000000000000000000000000a233441c94b2e13eaa9147849c1ed7e774c03047000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016e0000000000000000000000000000000000000000000000000000000001505126e11b93b61f6291d35c5a2bea0a9ff169080160cfeb466342c4d449bc9f53a865d5cb90586f4052150004f41766d80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000001111111254eeb25477b68fb85ed929f73a9605820000000000000000000000000000000000000000000000000000000065165f3c0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000eb466342c4d449bc9f53a865d5cb90586f405215000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000008b1ccac8",
            100,
            0x0a1d576f3eFeF75b330424287a95A366e8281D54
        );
    }

    // function test_swap() public {
    //     deal(axlUSDC, address(yield), 1e18);
    //     assertEq(IERC20(axlUSDC).balanceOf(address(yield)), 1e18);
    //     yield.swapWith1Inch(
    //         "0x12aa3caf00000000000000000000000026271dfddbd250014f87f0f302c099d5a798bab1000000000000000000000000eb466342c4d449bc9f53a865d5cb90586f405215000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000026271dfddbd250014f87f0f302c099d5a798bab1000000000000000000000000a233441c94b2e13eaa9147849c1ed7e774c03047000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016e0000000000000000000000000000000000000000000000000000000001505126e11b93b61f6291d35c5a2bea0a9ff169080160cfeb466342c4d449bc9f53a865d5cb90586f4052150004f41766d80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000001111111254eeb25477b68fb85ed929f73a9605820000000000000000000000000000000000000000000000000000000065165f3c0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000eb466342c4d449bc9f53a865d5cb90586f405215000000000000000000000000d9aaec86b65d86f6a7b5b1b0c42ffa531710b6ca00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000008b1ccac8"
    //     );
    // }
}
